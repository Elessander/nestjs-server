version: '3'
services:
  frontend:
    image: elessanderunc/nextjs-frontend:1.0 
    ports: ["3001:3000"]
    environment:
      NEXT_PUBLIC_BACKEND_URL: http://nestjs:3000
      depends_on:
      - nestjs
    restart: always

  nestjs:
    image: elessanderunc/nestjs-server:1.0
    restart: always
    ports:
     - "3000:3000"
    pull_policy: always
    #env_file:
    #  - .env

  watchtower:
    image: containrrr/watchtower
    container_name: watchtower
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    command: --cleanup --interval 60
    restart: always